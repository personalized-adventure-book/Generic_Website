<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Dynamic Order Form</title>
  <style>
    body { font-family: sans-serif; padding: 2rem; }
    form div { margin-bottom: 1rem; }
    label { font-weight: bold; display: block; margin-bottom: 0.25rem; }
    input { padding: 0.5rem; width: 100%; max-width: 300px; }
  </style>
</head>
<body>
  <h1>Order Form</h1>
  <form id="order-form">
    <!-- ← Static form skeleton: one field per sheet column -->
    <div>
      <label for="field1">First Name</label>
      <input id="field1" name="firstName" type="text" />
    </div>
    <div>
      <label for="field2">Email</label>
      <input id="field2" name="email" type="email" />
    </div>
    <div>
      <label for="field3">Product</label>
      <input id="field3" name="product" type="text" />
    </div>
    <div>
      <label for="field4">Quantity</label>
      <input id="field4" name="quantity" type="number" />
    </div>
    <!-- …add or remove these <div> blocks so you have exactly one field per column -->
  </form>

  <script>
    // 1) get ?id= from the URL (default to "1")
    function getParam(name, def) {
      const v = new URLSearchParams(location.search).get(name);
      return v === null ? def : v;
    }
    const id = getParam("id", "1");

    // 2) JSON-P callback: `rowValues` is an array of cell contents
    function initFormFields(rowValues) {
      rowValues.forEach((val, i) => {
        const inp = document.getElementById("field" + (i+1));
        if (inp) inp.value = val;   // inject your sheet’s cell into the input
      });
    }

    // 3) inject the <script> tag to fetch only that row’s data
    ;(function(){
      const s = document.createElement("script");
      s.src = "https://script.google.com/macros/s/AKfycbxomnBCc-HtyYOogmi0ljnrK_SLyWAIM57TkUfemDO1Ou0lo9_08DnuMKnW-7qF3wdB/exec"
            + "?id="       + encodeURIComponent(id)
            + "&callback=" + "initFormFields";
      document.body.appendChild(s);
    })();
  </script>
</body>
</html>