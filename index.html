<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Dynamic Order Form</title>
  <style>
    body { font-family: sans-serif; padding: 2rem; }
    form div { margin-bottom: 1rem; }
    label { font-weight: bold; display: block; margin-bottom: 0.25rem; }
    input { padding: 0.5rem; width: 100%; max-width: 300px; }
  </style>
</head>
<body>
  <h1>Order Form</h1>
  <form id="order-form">
    <!-- STATIC skeleton: one field per column in your sheet -->
    <div>
      <label id="label1" for="field1">Field 1</label>
      <input id="field1" name="Field 1" type="text" />
    </div>
    <div>
      <label id="label2" for="field2">Field 2</label>
      <input id="field2" name="Field 2" type="text" />
    </div>
    <div>
      <label id="label3" for="field3">Field 3</label>
      <input id="field3" name="Field 3" type="text" />
    </div>
    <div>
      <label id="label4" for="field4">Field 4</label>
      <input id="field4" name="Field 4" type="text" />
    </div>
    <!-- â†’ Add or remove divs to match the exact number of columns in your sheet -->
  </form>

  <script>
    // 1) Get ?id= from URL (default 1)
    function getParam(name, def) {
      const v = new URLSearchParams(location.search).get(name);
      return v === null ? def : v;
    }
    const id = getParam("id", "1");

    // 2) JSON-P callback: just rename labels & set placeholders
    function initFormFields(data) {
      const headers = data.headers  || [];
      const values  = data.values   || [];
      headers.forEach((hdr, i) => {
        // update label text
        const lbl = document.getElementById("label" + (i+1));
        if (lbl) lbl.textContent = hdr;

        // update input name + placeholder/value
        const inp = document.getElementById("field" + (i+1));
        if (inp) {
          inp.name = hdr;
          inp.placeholder = values[i] || "";
          inp.value       = values[i] || "";
        }
      });
    }

    // 3) Inject the JSON-P <script>
    ;(function(){
      const script = document.createElement("script");
      script.src = "https://script.google.com/macros/s/AKfycbxomnBCc-HtyYOogmi0ljnrK_SLyWAIM57TkUfemDO1Ou0lo9_08DnuMKnW-7qF3wdB/exec"
                   + "?id="       + encodeURIComponent(id)
                   + "&callback=" + "initFormFields";
      document.body.appendChild(script);
    })();
  </script>
</body>
</html>