<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>My Custom Shop</title>
  <style>
    * { box-sizing: border-box; }
    body { margin: 0; font-family: 'Segoe UI', sans-serif; background: #f5f7fa; color: #333; }
    header, footer { background: #4a90e2; color: white; padding: 1rem 2rem; }
    header nav a { margin: 0 1rem; color: white; text-decoration: none; font-weight: bold; }
    main { padding: 2rem; max-width: 1000px; margin: auto; }
    section { margin-bottom: 4rem; }
    h1, h2 { color: #4a90e2; }
    .btn-order { background: #4a90e2; color: white; border: none; padding: 0.75rem 1.5rem; font-size: 1.1rem; border-radius: 6px; cursor: pointer; }
    .btn-order:hover { background: #357acc; }
    form { background: white; padding: 2rem; border-radius: 8px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
    form div { margin-bottom: 1.5rem; }
    label { font-weight: bold; display: block; margin-bottom: 0.4rem; }
    input, select, textarea { width: 100%; padding: 0.75rem; border: 1px solid #ccc; border-radius: 6px; }
    .step { display: none; }
    .step.active { display: block; }
    .dynamic-field { margin-top: 1rem; }
    footer { text-align: center; font-size: 0.9rem; }
    footer a { color: white; text-decoration: underline; }
  </style>
</head>
<body>

<header>
  <h1>My Custom Shop</h1>
  <nav>
    <a href="#about">About</a>
    <a href="#products">Products</a>
    <a href="#faq">FAQ</a>
    <a href="#order">Order</a>
  </nav>
</header>

<main>
  <section id="about">
    <h2>About Us</h2>
    <p id="about-text">Loading…</p>
  </section>

  <section id="products">
    <h2>Our Products</h2>
    <p id="products-text">Loading…</p>
  </section>

  <section id="faq">
    <h2>FAQ</h2>
    <p id="faq-text">Loading…</p>
  </section>

  <section id="order">
    <h2>Place Your Order</h2>
    <form id="order-form">
      <div class="step step-1 active">
        <h3>Step 1: Personal Information</h3>
        <div>
          <label for="name">Full Name</label>
          <input type="text" id="name" name="name" required />
        </div>
        <div>
          <label for="email">Email</label>
          <input type="email" id="email" name="email" required />
        </div>
        <button type="button" class="btn-order" onclick="nextStep()">Next</button>
      </div>

      <div class="step step-2">
        <h3>Step 2: Product Customization</h3>
        <div>
          <label for="product">Choose Product</label>
          <select id="product" name="product">
            <option value="book">Personalized Adventure Book</option>
            <option value="button">Custom Button</option>
          </select>
        </div>
        <div id="dynamic-fields"></div>

        <button type="button" class="btn-order" onclick="prevStep()">Back</button>
        <button type="submit" class="btn-order">Submit</button>
      </div>
    </form>
  </section>
</main>

<footer>
  <p>&copy; 2025 My Custom Shop | <a href="#">Privacy</a> | <a href="#">Terms</a></p>
</footer>

<script>
  const id = new URLSearchParams(location.search).get("id") || "1";
  let allFields = [];

  function init(row) {
    const [about, products, faq, fieldJson] = row;

    document.getElementById("about-text").innerText = about;
    document.getElementById("products-text").innerText = products;
    document.getElementById("faq-text").innerText = faq;

    try {
      allFields = JSON.parse(fieldJson);
    } catch (e) {
      console.error("Invalid JSON in sheet:", e);
      return;
    }

    document.getElementById("product").addEventListener("change", renderFields);
    renderFields();
  }

  function renderFields() {
    const product = document.getElementById("product").value;
    const container = document.getElementById("dynamic-fields");
    container.innerHTML = "";

    allFields
      .filter(f => f.product === product)
      .forEach((field, i) => {
        const div = document.createElement("div");
        div.className = "dynamic-field";

        const label = document.createElement("label");
        label.innerText = field.label;
        label.htmlFor = "field" + i;

        let input;
        if (field.type === "select") {
          input = document.createElement("select");
          input.name = field.label;
          input.id = "field" + i;
          (field.options || []).forEach(opt => {
            const option = document.createElement("option");
            option.value = opt;
            option.innerText = opt;
            input.appendChild(option);
          });
        } else {
          input = document.createElement("input");
          input.type = field.type || "text";
          input.name = field.label;
          input.id = "field" + i;
          input.placeholder = field.label;
        }

        div.appendChild(label);
        div.appendChild(input);
        container.appendChild(div);
      });
  }

  function nextStep() {
    document.querySelector(".step-1").classList.remove("active");
    document.querySelector(".step-2").classList.add("active");
  }

  function prevStep() {
    document.querySelector(".step-2").classList.remove("active");
    document.querySelector(".step-1").classList.add("active");
  }

  // Load Google Apps Script Data
  (function () {
    const s = document.createElement("script");
    s.src =
      "https://script.google.com/macros/s/AKfycbxomnBCc-HtyYOogmi0ljnrK_SLyWAIM57TkUfemDO1Ou0lo9_08DnuMKnW-7qF3wdB/exec" +
      "?id=" + encodeURIComponent(id) +
      "&callback=init";
    document.body.appendChild(s);
  })();
</script>

</body>
</html>